

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Aard Tools &mdash; aarddict v0.9.1 documentation</title>
    <link rel="stylesheet" href="../../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.9.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../static/jquery.js"></script>
    <script type="text/javascript" src="../../static/underscore.js"></script>
    <script type="text/javascript" src="../../static/doctools.js"></script>
    <link rel="top" title="aarddict v0.9.1 documentation" href="../../index.html" />
    <link rel="next" title="Aard Format" href="aardformat.html" />
    <link rel="prev" title="Aard Dictionary for Android" href="../../aarddict-android/doc/aarddict-android.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="aardformat.html" title="Aard Format"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../aarddict-android/doc/aarddict-android.html" title="Aard Dictionary for Android"
             accesskey="P">previous</a> |</li>
<li><a href="../../index.html" style="text-decoration: none;"><img src="../../static/aarddict_small.png"
					  alt="Aard Dictionary small
					  logo"
					  title="Aard Dictionary Home"
					  style="vertical-align:
					  middle;
					  padding-bottom: 3px;					  
					  "/>

</li>
<li><a href="../../download.html">Download</a> | </li>
<li><a href="../../dictionaries.html">Dictionaries</a> | </li>
<li><a href="../../contents.html">Docs</a> | </li>
<li><a href="../../store.html">Store</a> | </li>
<li>
<a href="http://www.twitter.com/aarddict">
  <img src="http://twitter-badges.s3.amazonaws.com/t_small-a.png"
       alt="Follow aarddict on
	    Twitter" style="vertical-align: middle;"/>
</a>
</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-aardtools">
<span id="aard-tools"></span><h1>Aard Tools<a class="headerlink" href="#module-aardtools" title="Permalink to this headline">¶</a></h1>
<p><em>Platforms: </em>Unix</p>
<p>Aard Dictionary uses dictionaries in it&#8217;s own
<a class="reference internal" href="aardformat.html"><em>binary format</em></a> designed for fast word lookups and high
compression. <cite>Aard Tools</cite> is a collection of tools to produce
<a class="reference internal" href="aardformat.html"><em>Aard files</em></a> (<tt class="docutils literal"><span class="pre">.aar</span></tt>).</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Examples below use <tt class="docutils literal"><span class="pre">apt-get</span></tt> on Ubuntu Linux. Consult your
distibution&#8217;s packaging system to find corresponding package names
and commands to install them.</p>
</div>
<div class="section" id="prerequisits">
<h3>Prerequisits<a class="headerlink" href="#prerequisits" title="Permalink to this headline">¶</a></h3>
<p>Your system must be able to compile C and C++ programs:</p>
<div class="highlight-python"><pre>sudo apt-get install build-essential</pre>
</div>
<p>You will also need to have Python headers and <a class="reference external" href="http://peak.telecommunity.com/DevCenter/setuptools">setuptools</a> installed:</p>
<div class="highlight-python"><pre>sudo apt-get install python-dev python-setuptools</pre>
</div>
<p><cite>Aard Tools</cite> rely on Python interfaces to
<a class="reference external" href="http://icu-project.org/">International Components for Unicode</a> , which must be installed
beforehand:</p>
<div class="highlight-python"><pre>sudo apt-get install libicu38 libicu-dev</pre>
</div>
<p>If you would like to get source code repository you will need
<a class="reference external" href="http://selenic.com/mercurial">Mercurial</a>:</p>
<div class="highlight-python"><pre>sudo apt-get install mercurial</pre>
</div>
<p>When compiling Wikipedia into dictionary with HTML articles <cite>Aard
Tools</cite> renders mathematical formulas using several tools: <strong class="command">latex</strong>,
<strong class="command">blahtexml</strong>, <strong class="command">texvc</strong> and <strong class="command">dvipng</strong>.</p>
<p>Install <strong class="command">latex</strong>:</p>
<div class="highlight-python"><pre>sudo apt-get install texlive-latex-base</pre>
</div>
<p>Install <strong class="command">blahtexml</strong> following instructions at
<a class="reference external" href="http://gva.noekeon.org/blahtexml/">http://gva.noekeon.org/blahtexml/</a></p>
<p>Install <strong class="command">texvc</strong> (it is part of MediaWiki distribution):</p>
<div class="highlight-python"><pre>sudo apt-get install mediawiki-math</pre>
</div>
<p>Install <strong class="command">dvipng</strong>:</p>
<div class="highlight-python"><pre>sudo apt-get install dvipng</pre>
</div>
<p><strong class="command">texvc</strong> is what Wikipedia uses to render math and it&#8217;s most compatible
with the TeX markup flavour used in Wikipedia articles. However, png
images produced by texvc are not transparent and don&#8217;t look very
good. <strong class="command">blahtexml</strong> has a <strong class="command">texvc</strong> compatibility mode, produces better
looking images, but is more strict about TeX syntax, so it fails on
quite a few equations. So first thing article converter tries is using
<strong class="command">latex</strong> and <strong class="command">dvipng</strong> directly, with some additional LaTeX command
definitions for <strong class="command">texvc</strong> compatibility (borrowed from
<strong class="command">blahtexml</strong>). This produces best looking images and works on most
equations, but not all of them. When it fails, it falls back to
<strong class="command">blahtexml</strong>, and then finally <strong class="command">texvc</strong>. If all fails (for example
neither tools is installed) article ends up with raw math markup.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This applies to HTML article format (<a class="reference internal" href="aardformat.html#term-aar-html"><em class="xref std std-term">aar-HTML</em></a>), which is what aardtools 0.8.0
uses for Wikipedia by default. Articles in older JSON format (<a class="reference internal" href="aardformat.html#term-aar-json"><em class="xref std std-term">aar-JSON</em></a>) do not
support math rendering.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">aarddict 0.7.x can&#8217;t render <a class="reference internal" href="aardformat.html#term-aar-html"><em class="xref std std-term">aar-HTML</em></a> articles, will show raw HTML.</p>
</div>
</div>
<div class="section" id="id1">
<h3>Installation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Download source code:</p>
<div class="highlight-python"><pre>wget http://www.bitbucket.org/itkach/aardtools/get/tip.bz2</pre>
</div>
<p>or</p>
<div class="highlight-python"><pre>hg clone http://www.bitbucket.org/itkach/aardtools</pre>
</div>
<p>Assuming source code code is in <cite>aardtools</cite> directory:</p>
<div class="highlight-python"><pre>cd aardtools
sudo python setup.py install</pre>
</div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Entry point for <cite>Aard Tools</cite> is <tt class="docutils literal"><span class="pre">aardc</span></tt> command - Aard Dictionary compiler. It
requires two arguments: input file type and input file name. Input
file type is the name of Python module that actually reads input files and
performs article conversion. <cite>Aard Tools</cite> &#8220;out of the box&#8221; comes with
support for the following input types:</p>
<dl class="docutils">
<dt>xdxf</dt>
<dd>Dictionaries in <a class="reference external" href="http://xdxf.sourceforge.net/">XDXF</a> format (only <a class="reference external" href="http://xdxf.revdanica.com/drafts/visual/latest/XDXF-draft-028.txt">XDXF-visual</a> is supported).</dd>
<dt>wiki</dt>
<dd>Wikipedia articles and templates <abbr title="Constant Database">CDB</abbr>
built with <strong class="command">mw-buildcdb</strong> from Wikipedia XML dump.</dd>
<dt>aard</dt>
<dd>Dictionaries in aar format. This is useful for updating dictionary metadata
and changing the way it is split into volumes. Multiple input files can
be combined into one single or multi volume fictionary.</dd>
</dl>
<p>Synopsis:</p>
<div class="highlight-python"><pre>aardc [options] (wiki|xdxf|aard) FILE [FILE2 [FILE3 ...]]</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only <cite>aard</cite> input type allows multiple files.</p>
</div>
<div class="section" id="compiling-wiki-xml-dump">
<h3>Compiling Wiki XML Dump<a class="headerlink" href="#compiling-wiki-xml-dump" title="Permalink to this headline">¶</a></h3>
<p>Get a Wiki dump to compile, for example:</p>
<div class="highlight-python"><pre>wget http://download.wikimedia.org/simplewiki/20081227/simplewiki-20081227-pages-articles.xml.bz2</pre>
</div>
<p>Build mwlib article database:</p>
<div class="highlight-python"><pre>mw-buildcdb --input  simplewiki-20081227-pages-articles.xml.bz2 --output simplewiki-20081227-pages-articles.cdb</pre>
</div>
<p>Original dump is not needed after this, it may be deleted or moved to
free up disk space. Compile aar dictionary from the article database:</p>
<div class="highlight-python"><pre>aardc wiki simplewiki-20081227-pages-articles.cdb</pre>
</div>
<p>Compiler infers from the input file name that Wikipedia language
is &#8220;simple&#8221; and that version is 20081227. These need to be specified
explicitely through command line options if cdb directory name doesn&#8217;t
follow the pattern of the xml dump file names. Compiler also
looks for files with license and copyright notice texts and dictionary
metadata, first in the language of the wiki and then in
English. English versions of these files are included.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure <tt class="file docutils literal"><em><span class="pre">mwlibdir</span></em><span class="pre">/mwlib/siteinfo</span></tt> directory contains
file <tt class="file docutils literal"><span class="pre">siteinfo-</span><em><span class="pre">lang</span></em><span class="pre">.json</span></tt> for language of wiki to be
compiled. If it doesn&#8217;t - run
<tt class="samp docutils literal"><em><span class="pre">mwlibdir</span></em><span class="pre">/mwlib/siteinfo/fetch_siteinfo.py</span> <em><span class="pre">lang</span></em></tt>.</p>
</div>
</div>
<div class="section" id="compiling-xdxf-dictionaries">
<h3>Compiling XDXF Dictionaries<a class="headerlink" href="#compiling-xdxf-dictionaries" title="Permalink to this headline">¶</a></h3>
<p>Get a XDXF dictionary, for example:</p>
<div class="highlight-python"><pre>wget http://downloads.sourceforge.net/xdxf/comn_dictd04_wn.tar.bz2</pre>
</div>
<p>Compile aar dictionary:</p>
<div class="highlight-python"><pre>aardc xdxf comn_dictd04_wn.tar.bz2</pre>
</div>
</div>
<div class="section" id="compiling-aard-dictionaries">
<h3>Compiling Aard Dictionaries<a class="headerlink" href="#compiling-aard-dictionaries" title="Permalink to this headline">¶</a></h3>
<p>.aar dictionaries themselves can be used as input for aardc. This is useful
when dictionary&#8217;s metadata need to be updated or dictionary needs to be split
up into several smaller volumes. For example, to split large dictionary
<cite>dict.aar</cite> into volumes with maximum size of 10 Mb run:</p>
<div class="highlight-python"><pre>aardc aard dict.aar -o dict-split.aar -s 10m</pre>
</div>
<p>If <cite>dict.aar</cite> is, say, 15 Mb this will produce two files: 10 Mb <cite>dict-split.1_of_2.aar</cite>
and 5Mb <cite>dict-split.2_of_2.aar</cite>.</p>
<p>To update dictionary metadata:</p>
<div class="highlight-python"><pre>aardc aard dict.aar -o dict2.aar --metadata dict.ini</pre>
</div>
</div>
</div>
<div class="section" id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>0.8.1<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Exclude more boxes, exclude sister and inter project links</li>
<li>Add <tt class="docutils literal"><span class="pre">--article-count</span></tt> option - compile specified number of articles,
not counting redirects</li>
<li>Change article format for xdxf from json to html</li>
<li>Add option <tt class="docutils literal"><span class="pre">--skip-article-title</span></tt> for xdxf to not add article title
at the beginning of article (some dicitonaries already have it)</li>
<li>Remove support for article <a class="reference internal" href="aardformat.html#term-aar-json"><em class="xref std std-term">aar-JSON</em></a> article format</li>
<li>Add command to fetch siteinfo, require that siteinfo file is
explicitely specified with <tt class="docutils literal"><span class="pre">--siteinfo</span></tt> option</li>
<li>Don&#8217;t load default license, copyright and metadata files, don&#8217;t
provide any defaults when loading specified metadata</li>
<li>Don&#8217;t include any language links languages by defualt</li>
<li>Add known wiki licenses</li>
<li>Better version guessing from file name</li>
<li>Updated mwlib dependency to 0.12.13</li>
<li>Make compiler work with aarddict 0.9.0</li>
</ul>
</div>
<div class="section" id="id3">
<h3>0.8.0<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Use json module from standard lib if using Python 2.6</li>
<li>Update mwlib dependency to 0.12.10</li>
<li>Add option to convert Wikipedia articles to HTML instead of JSON</li>
<li>Render math in Wikipedia articles (when converting to HTML)</li>
<li>Properly handle multiple occurences of named references in Wikipedia
articles (when converting to HTML)</li>
<li>Properly handle multiple reference lists in Wikipedia
articles (when converting to HTML)</li>
<li>Use upwords arrow character instead of ^ for footnote back
references</li>
<li>Add list of language link languages to metadata</li>
<li>Generate smaller dictionaries when compiling Wikipedia by excluding
more metadata, navigation and image related elements</li>
</ul>
</div>
<div class="section" id="id4">
<h3>0.7.6<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Add Wikipedia language link support (include article titles from
language links into index for languages specified with <tt class="docutils literal"><span class="pre">--lang-links</span></tt>
option)</li>
<li>Rework title sorting implementation to speed up title sorting step</li>
<li>Use simple text file with index instead of shelve for temporary
article storage to reduce disk space requirements</li>
<li>Change default max file size to 2 <sup>31</sup> - 1 instead of
2 <sup>32</sup> - 1</li>
</ul>
</div>
<div class="section" id="id5">
<h3>0.7.5<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Include license, doc and wiki files in source distribution generated
by setuptools</li>
<li>Write Wikipedia siteinfo to dictionary metadata</li>
<li>Exclude elements with classes <cite>navbar</cite> and <cite>plainlinksneverexpand</cite>,
this get&#8217;s rid of talk-view-edit links in wiki articles</li>
<li>Discard generic tag attributes when parsing wiki since they are not
used</li>
<li>Updated Wikipedia copyright and license information to reflect
Wikipedia&#8217;s switch to Common Attribution license</li>
<li>Removed dependency on <a class="reference external" href="http://codespeak.net/lxml/">lxml</a></li>
<li>Moved converter specific functions to converter modules, this
makes it possible to implement new converters without changing
compiler.py</li>
<li>Parse XDXF&#8217;s <tt class="docutils literal"><span class="pre">nu</span></tt> and <tt class="docutils literal"><span class="pre">opt</span></tt> tags</li>
</ul>
</div>
<div class="section" id="id6">
<h3>0.7.4<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Improved Wiki redirect parsing: case insensitive, recognize
site-specific redirect magic word aliases</li>
<li>Improved statisics, logging and progress display</li>
<li>Improved stability and memory usage</li>
<li>Better guess wiki language and version from input file name</li>
</ul>
</div>
<div class="section" id="id7">
<h3>0.7.3<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Compile wiki directly from CDB (original wiki xml dump is no longer
needed after generating CDB)</li>
<li>Infer wiki language and version from input file name if it follows
the same pattern as wiki xml dump file names</li>
<li>Include a copy of GNU Free Documentation License, wiki copyright
notice text and general description, write this into
dictionary metadata by default</li>
<li>Improve memory usage (<a class="reference external" href="http://bitbucket.org/itkach/aardtools/issue/4">issue #4</a>)</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Aard Tools</a><ul>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#prerequisits">Prerequisits</a></li>
<li><a class="reference internal" href="#id1">Installation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#compiling-wiki-xml-dump">Compiling Wiki XML Dump</a></li>
<li><a class="reference internal" href="#compiling-xdxf-dictionaries">Compiling XDXF Dictionaries</a></li>
<li><a class="reference internal" href="#compiling-aard-dictionaries">Compiling Aard Dictionaries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#release-notes">Release Notes</a><ul>
<li><a class="reference internal" href="#id2">0.8.1</a></li>
<li><a class="reference internal" href="#id3">0.8.0</a></li>
<li><a class="reference internal" href="#id4">0.7.6</a></li>
<li><a class="reference internal" href="#id5">0.7.5</a></li>
<li><a class="reference internal" href="#id6">0.7.4</a></li>
<li><a class="reference internal" href="#id7">0.7.3</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../../aarddict-android/doc/aarddict-android.html"
                        title="previous chapter">Aard Dictionary for Android</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="aardformat.html"
                        title="next chapter">Aard Format</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../sources/aardtools/doc/aardtools.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="aardformat.html" title="Aard Format"
             >next</a> |</li>
        <li class="right" >
          <a href="../../aarddict-android/doc/aarddict-android.html" title="Aard Dictionary for Android"
             >previous</a> |</li>
<li><a href="../../index.html" style="text-decoration: none;"><img src="../../static/aarddict_small.png"
					  alt="Aard Dictionary small
					  logo"
					  title="Aard Dictionary Home"
					  style="vertical-align:
					  middle;
					  padding-bottom: 3px;					  
					  "/>

</li>
<li><a href="../../download.html">Download</a> | </li>
<li><a href="../../dictionaries.html">Dictionaries</a> | </li>
<li><a href="../../contents.html">Docs</a> | </li>
<li><a href="../../store.html">Store</a> | </li>
<li>
<a href="http://www.twitter.com/aarddict">
  <img src="http://twitter-badges.s3.amazonaws.com/t_small-a.png"
       alt="Follow aarddict on
	    Twitter" style="vertical-align: middle;"/>
</a>
</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2010, Igor Tkach.
      Last updated on Oct 26, 2010.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>
  </body>
</html>